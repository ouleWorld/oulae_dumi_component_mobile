"use strict";(self.webpackChunkoulae_dumi_component_mobile=self.webpackChunkoulae_dumi_component_mobile||[]).push([[129],{40129:function(pt,k,f){f.r(k),f.d(k,{BodyMask:function(){return Q},Foo:function(){return Z},ImageCheck:function(){return _},SwiperTouchAnimation:function(){return ut}});var B=f(42122),b=f.n(B),X=f(67294),G=f(73935),W={bodyMastRoot:"cq7hzOIX941CzaFrgA9O",mask:"WBzMgNsaKYQG8qJnTjOC"},D=f(85893),$=X.useEffect,J=X.useRef,j=function(i){var a=i.visible,n=i.children,l=i.style,c=l===void 0?{}:l,s=i.maskBgColor,r=i.clickMaskCallback,w=J(document.createElement("div")),L=b()(b()({},c),{},{backgroundColor:s||"rgba(0,0,0,.45)"});return $(function(){document.body.appendChild(w.current)}),a&&G.createPortal((0,D.jsxs)("div",{className:W.bodyMastRoot,children:[(0,D.jsx)("div",{className:W.mask,style:b()({},L),onClick:function(){console.log("\u70B9\u51FB\u4E86 mask"),r&&r()}}),n]}),w.current)};j.defaultProps={style:{},maskBgColor:"rgba(0, 0, 0, 0.45)"};var Q=j,V=function(i){return(0,D.jsx)("h4",{children:i.title})},Z=V,R={container:"Mv9u2esG2SYfRa3R6WQ4",log:"ZSH8QNcAbY4JNomsmEaF"},K=f(74704),U=f.n(K);function y(t,i){this.element=t,this.options=i,this.point1={x:0,y:0},this.point2={x:0,y:0},this.lastPoint1={x:0,y:0},this.lastPoint2={x:0,y:0},this.distance={x:0,y:0},this.lastDistance={x:0,y:0},this.lastPointermove={x:0,y:0},this.lastCenter={x:0,y:0},this.tapCount=0,this.points=[],this.pointers=[],this.dragDirection="",this.isPointerdown=!1,this.singleTapTimeout=null,this.longTapTimeout=null,this.bindEventListener()}y.prototype.handlePointerdown=function(t){var i=this;if(!(t.pointerType==="mouse"&&t.button!==0)){if(this.pointers.push(t),this.point1.x=this.pointers[0].clientX,this.point1.y=this.pointers[0].clientY,this.pointers.length===1)this.isPointerdown=!0,this.element.setPointerCapture(t.pointerId),this.tapCount++,this.dragDirection="",this.points.length=0,clearTimeout(this.singleTapTimeout),this.distance.x=0,this.distance.y=0,this.lastDistance.x=0,this.lastDistance.y=0,this.lastPointermove.x=this.pointers[0].clientX,this.lastPointermove.y=this.pointers[0].clientY,this.tapCount>1&&(Math.abs(this.point1.x-this.lastPoint1.x)>30||Math.abs(this.point1.y-this.lastPoint1.y)>30)&&(this.tapCount=1),this.tapCount===1&&(this.longTapTimeout=setTimeout(function(){i.tapCount=0,i.options.longTap&&i.options.longTap(t)},500));else if(this.pointers.length===2){this.tapCount=0,clearTimeout(this.longTapTimeout),this.point2.x=this.pointers[1].clientX,this.point2.y=this.pointers[1].clientY,this.lastPoint2.x=this.pointers[1].clientX,this.lastPoint2.y=this.pointers[1].clientY,this.lastDistance.x=this.distance.x,this.lastDistance.y=this.distance.y;var a=this.getCenter(this.point1,this.point2);this.lastCenter.x=a.x,this.lastCenter.y=a.y}this.lastPoint1={x:this.pointers[0].clientX,y:this.pointers[0].clientY},this.options.pointerdown&&this.options.pointerdown(t)}},y.prototype.handlePointermove=function(t){if(this.isPointerdown){this.handlePointers(t,"update");var i={x:this.pointers[0].clientX,y:this.pointers[0].clientY};if(this.pointers.length===1)this.distance.x=i.x-this.point1.x+this.lastDistance.x,this.distance.y=i.y-this.point1.y+this.lastDistance.y,(Math.abs(this.distance.x)>10||Math.abs(this.distance.y)>10)&&(this.tapCount=0,clearTimeout(this.longTapTimeout),this.dragDirection===""&&(this.dragDirection=this.getDragDirection())),this.points.unshift({x:i.x,y:i.y,timeStamp:t.timeStamp}),this.points.length>20&&this.points.pop(),this.handleDrag(t,i),this.lastPointermove.x=i.x,this.lastPointermove.y=i.y;else if(this.pointers.length===2){var a={x:this.pointers[1].clientX,y:this.pointers[1].clientY},n=this.getCenter(i,a);t._centerX=n.x,t._centerY=n.y,t._lastCenterX=this.lastCenter.x,t._lastCenterY=this.lastCenter.y,this.handleRotate(t,i,a),this.handlePinch(t,i,a),this.lastPoint1.x=i.x,this.lastPoint1.y=i.y,this.lastPoint2.x=a.x,this.lastPoint2.y=a.y,this.lastCenter.x=n.x,this.lastCenter.y=n.y}this.options.pointermove&&this.options.pointermove(t),t.preventDefault()}},y.prototype.handlePointerup=function(t){var i=this;this.isPointerdown&&(this.handlePointers(t,"delete"),this.pointers.length===0?(this.isPointerdown=!1,clearTimeout(this.longTapTimeout),this.tapCount===0?this.handleSwipe(t):(this.options.tap&&this.options.tap(t),this.tapCount===1?this.singleTapTimeout=setTimeout(function(){i.tapCount=0,i.options.singleTap&&i.options.singleTap(t)},250):this.tapCount>1&&(this.tapCount=0,this.options.doubleTap&&this.options.doubleTap(t)))):this.pointers.length===1&&(this.point1.x=this.pointers[0].clientX,this.point1.y=this.pointers[0].clientY,this.lastPointermove.x=this.pointers[0].clientX,this.lastPointermove.y=this.pointers[0].clientY),this.options.pointerup&&this.options.pointerup(t))},y.prototype.handlePointercancel=function(t){this.isPointerdown=!1,this.tapCount=0,clearTimeout(this.longTapTimeout),this.pointers.length=0,this.options.pointercancel&&this.options.pointercancel(t)},y.prototype.handlePointers=function(t,i){for(var a=0;a<this.pointers.length;a++)this.pointers[a].pointerId===t.pointerId&&(i==="update"?this.pointers[a]=t:i==="delete"&&this.pointers.splice(a,1))},y.prototype.getDragDirection=function(){var t="";return Math.abs(this.distance.x)>Math.abs(this.distance.y)?t=this.distance.x>0?"right":"left":t=this.distance.y>0?"down":"up",t},y.prototype.handleDrag=function(t,i){t._dragDirection=this.dragDirection,t._diffX=i.x-this.lastPointermove.x,t._diffY=i.y-this.lastPointermove.y,t._distanceX=i.x-this.point1.x+this.lastDistance.x,t._distanceY=i.y-this.point1.y+this.lastDistance.y,this.options.drag&&this.options.drag(t)},y.prototype.handleSwipe=function(t){var i=20,a=0,n=0,l=U()(this.points),c;try{for(l.s();!(c=l.n()).done;){var s=c.value;if(t.timeStamp-s.timeStamp<200)a=t.clientX-s.x,n=t.clientY-s.y;else break}}catch(r){l.e(r)}finally{l.f()}(Math.abs(a)>i||Math.abs(n)>i)&&(Math.abs(a)>Math.abs(n)?t._swipeDirection=a>0?"right":"left":t._swipeDirection=n>0?"down":"up",this.options.swipe&&this.options.swipe(t))},y.prototype.handleRotate=function(t,i,a){t._rotate=this.getAngle(i,a)-this.getAngle(this.lastPoint1,this.lastPoint2),this.options.rotate&&this.options.rotate(t)},y.prototype.handlePinch=function(t,i,a){t._scale=this.getDistance(i,a)/this.getDistance(this.lastPoint1,this.lastPoint2),this.options.pinch&&this.options.pinch(t)},y.prototype.handleWheel=function(t){t._scale=1.1,t.deltaY>0&&(t._scale=1/1.1),this.options.wheel&&this.options.wheel(t)},y.prototype.bindEventListener=function(){this.handlePointerdown=this.handlePointerdown.bind(this),this.handlePointermove=this.handlePointermove.bind(this),this.handlePointerup=this.handlePointerup.bind(this),this.handlePointercancel=this.handlePointercancel.bind(this),this.handleWheel=this.handleWheel.bind(this),this.element.addEventListener("pointerdown",this.handlePointerdown),this.element.addEventListener("pointermove",this.handlePointermove),this.element.addEventListener("pointerup",this.handlePointerup),this.element.addEventListener("pointercancel",this.handlePointercancel),this.element.addEventListener("wheel",this.handleWheel)},y.prototype.unbindEventListener=function(){this.element.removeEventListener("pointerdown",this.handlePointerdown),this.element.removeEventListener("pointermove",this.handlePointermove),this.element.removeEventListener("pointerup",this.handlePointerup),this.element.removeEventListener("pointercancel",this.handlePointercancel),this.element.removeEventListener("wheel",this.handleWheel)},y.prototype.destroy=function(){this.unbindEventListener()},y.prototype.getAngle=function(t,i){var a=t.x-i.x,n=t.y-i.y;return Math.atan2(n,a)*180/Math.PI},y.prototype.getDistance=function(t,i){var a=t.x-i.x,n=t.y-i.y;return Math.hypot(a,n)},y.prototype.getCenter=function(t,i){var a=(t.x+i.x)/2,n=(t.y+i.y)/2;return{x:a,y:n}},y.prototype.getImgSize=function(t,i,a,n){var l=t/i,c=a/n,s,r;return l>=c?t>a?(s=a,r=a/t*i):(s=t,r=i):i>n?(s=n/i*t,r=n):(s=t,r=i),{width:s,height:r}};var H=X.useRef,A=function(i){var a=i.src,n=H(null),l=H(null),c=H({width:0,height:0,imgWidth:0,imgHeight:0,maxScale:1,minScale:.5,x:0,y:0,initialX:0,initialY:0,scale:1,rotate:0}),s=function(M,x){c.current[M]=x},r=function(M){if(n.current){var x=c.current,u=x.x,p=x.y,m=x.scale,g=x.rotate;n.current.style.transition=M?"transform ".concat(M,"ms"):"none",n.current.style.transform="translate3d(".concat(u,"px, ").concat(p,"px, 0px) scale(").concat(m,") rotate(").concat(g,"deg)")}},w=function(M){if(l.current){var x=c.current,u=x.x,p=x.y,m=x.scale,g=x.rotate;M?l.current.innerHTML="x = ".concat(u.toFixed(0),"<br>y = ").concat(p.toFixed(0),"<br>scale = ").concat(m.toFixed(5),"<br>rotate = ").concat(g.toFixed(1),`<br>
        centerX = `).concat(M._centerX.toFixed(0),"<br>centerY = ").concat(M._centerY.toFixed(0),`<br>
        lastCenterX = `).concat(M._lastCenterX.toFixed(0),"<br>lastCenterY = ").concat(M._lastCenterY.toFixed(0)):l.current.innerHTML="x = ".concat(u.toFixed(0),"<br>y = ").concat(p.toFixed(0),"<br>scale = ").concat(m.toFixed(5),"<br>rotate = ").concat(g.toFixed(1))}},L=function(){if(n.current){var M=new y(n.current,{doubleTap:function(e){var o=c.current,d=o.scale,P=o.maxScale,C=o.imgWidth,I=o.imgHeight,Y=o.initialX,v=o.initialY,T=o.x,h=o.y,S=1/d;d<=1&&(S=P/d);var z={x:(S-1)*C*.5,y:(S-1)*I*.5};d<=1?(s("x",T-((S-1)*(e.clientX-T)-z.x)),s("y",h-((S-1)*(e.clientY-h)-z.y))):(s("x",Y),s("y",v)),s("scale",d*S),r(400),w()},drag:function(e){var o=c.current,d=o.x,P=o.y;s("x",d+e._diffX),s("y",P+e._diffY),r(null),w()},rotate:function(e){var o=c.current,d=o.imgWidth,P=o.imgHeight,C=o.x,I=o.y,Y=o.rotate,v={x:d*.5+C,y:P*.5+I},T={x:(v.x-e._centerX)*Math.cos(e._rotate*Math.PI/180)-(v.y-e._centerY)*Math.sin(e._rotate*Math.PI/180)+e._centerX,y:(v.x-e._centerX)*Math.sin(e._rotate*Math.PI/180)+(v.y-e._centerY)*Math.cos(e._rotate*Math.PI/180)+e._centerY};s("x",C-(v.x-T.x)),s("y",I-(v.y-T.y)),s("rotate",(Y+e._rotate+360)%360),r(null),w()},pinch:function(e){var o=c.current,d=o.scale,P=o.maxScale,C=o.minScale,I=o.imgWidth,Y=o.imgHeight,v=o.x,T=o.y,h=d*e._scale;h>P?(e._scale=P/d,s("scale",P)):h<C?(e._scale=C/d,s("scale",C)):s("scale",h);var S={x:(e._scale-1)*I*.5,y:(e._scale-1)*Y*.5};s("x",v-((e._scale-1)*(e._centerX-v)-S.x-(e._centerX-e._lastCenterX))),s("y",T-((e._scale-1)*(e._centerY-T)-S.y-(e._centerY-e._lastCenterY))),r(null),w(e)},wheel:function(e){var o=c.current,d=o.scale,P=o.maxScale,C=o.minScale,I=o.imgWidth,Y=o.imgHeight,v=o.x,T=o.y,h=d*e._scale;h>P?(e._scale=P/d,s("scale",P)):h<C?(e._scale=C/d,s("scale",C)):s("scale",h);var S={x:(e._scale-1)*I*.5,y:(e._scale-1)*Y*.5};s("x",v-((e._scale-1)*(e.clientX-v)-S.x)),s("y",T-((e._scale-1)*(e.clientX-v)-S.x)),r(null),w(),e.preventDefault()},pointerup:function(){var e=c.current,o=e.x,d=e.y,P=e.scale,C=e.imgWidth,I=e.initialX,Y=e.initialY;if(P===1){s("x",I),s("y",Y),r(400),w();return}var v=o,T=d,h=n.current.getBoundingClientRect();h.width>=window.innerWidth?h.right<window.innerWidth?v+=window.innerWidth-h.right:h.left>0&&(v=C*P/2-C/2):h.right>window.innerWidth?v-=h.right-window.innerWidth:h.left<0&&(v=C*P/2-C/2),h.height>=window.innerHeight?h.top>0?T-=h.top:h.bottom<window.innerHeight&&(T+=window.innerHeight-h.bottom):h.top<0?T+=-1*h.top:h.bottom>window.innerHeight&&(T-=h.bottom-window.innerHeight),s("x",v),s("y",T),r(400),w()}});s("width",n.current.naturalWidth),s("height",n.current.naturalHeight);var x=M.getImgSize(n.current.naturalWidth,n.current.naturalHeight,window.innerWidth,window.innerHeight);s("imgWidth",x.width),s("imgHeight",x.height);var u=c.current,p=u.imgWidth,m=u.imgHeight;s("x",(window.innerWidth-p)*.5),s("y",(window.innerHeight-m)*.5),s("initialX",(window.innerWidth-p)*.5),s("initialY",(window.innerHeight-m)*.5),s("maxScale",Math.max(Math.round(n.current.naturalWidth/p),3)),n.current.style.width=p+"px",n.current.style.height=m+"px",r(null),w()}};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:R.container,children:(0,D.jsx)("img",{ref:n,src:a,alt:"ceshi",onLoad:L})}),(0,D.jsx)("div",{ref:l,className:R.log})]})};A.defaultProps={src:"https://s.cn.bing.net/th?id=OHR.BuchsteinRossstein_ZH-CN4924477552_1920x1080.jpg&rf=LaDigue_1920x1080.jpg&qlt=50"};var _=A,q=f(27424),tt=f.n(q),it=f(94184),et=f.n(it),N={animationContainer:"I1vcTGPJIyvNcqC3yxCA",holder:"hiVoVD70AMo9TKS4e24I",animate:"zSV1auyJdMY0r7i1MicZ"},nt=f(3515),at=f.n(nt),st=f(56690),ot=f.n(st),rt=f(89728),lt=f.n(rt),ht=f(38416),O=f.n(ht),ct=function(i,a,n){var l=i.swiperPaginationNumber,c=Number((a/l*n).toFixed(0));return c},F=function(){function t(){ot()(this,t),O()(this,"id",void 0),this.id="animationCss"}return lt()(t,[{key:"append",value:function(){var a,n,l,c=document.createElement("style");c.type="text/css",c.innerHTML="",c.id=this.id,(a=document)===null||a===void 0||(n=a.getElementsByTagName("HEAD"))===null||n===void 0||(l=n.item(0))===null||l===void 0||l.appendChild(c)}},{key:"update",value:function(a){var n=document.querySelector("#animationCss");n&&(n.innerHTML=a)}}],[{key:"instance",value:function(){for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];return this.i=this.i||at()(this,n),this.i}}]),t}();O()(F,"i",void 0);var dt=(0,X.forwardRef)(function(t,i){var a=(0,X.useRef)({end:0}),n=t.animationFra,l=t.animationImgUrl,c=(0,X.useState)({touchMoveOutStatus:!1,allDistance:0,swiperPaginationNumber:0,animationTime:300,activeIndex:0,frames:0}),s=tt()(c,2),r=s[0],w=s[1],L=function(u,p){var m=r.frames,g=r.animationTime,e=Math.abs(u-m);if(e){var o=`
        @keyframes steps_vertical_icon {
          0% {
            background-position: 0% `.concat(Math.abs(m/n)*100,`%;
          }
          100% {
            background-position: 0% `).concat(Math.abs(u/n)*100,`%;
          }
        }

        .animate_gamelist_icon {
          animation-name: steps_vertical_icon;
          animation-duration: `).concat(g,`ms;
          animation-timing-function: steps(`).concat(Math.abs(u-m),`, end);
        }
      `);F.instance().update(o),setTimeout(function(){w(function(d){return b()(b()({},d),{},{touchMoveOutStatus:!0})})}),a.current.end=window.setTimeout(function(){w(function(d){return b()(b()({},d),{},{touchMoveOutStatus:!1,activeIndex:p,frames:u})}),setTimeout(function(){F.instance().update("")}),a.current.end=0},g)}};(0,X.useImperativeHandle)(i,function(){return{touchStart:function(u){var p,m=0,g=0,e=u.slidesSizesGrid.length;u.slidesSizesGrid[0]===u.slidesSizesGrid[e-1]?(m=u.slidesSizesGrid[0]*(e-1),g=e-1):(m=u.slidesSizesGrid[0]*(u.slidesSizesGrid.length-2),g=e-2);var o=((p=u.passedParams)===null||p===void 0?void 0:p.speed)||300;m!==r.allDistance&&w(function(d){return b()(b()({},d),{},{allDistance:m,swiperPaginationNumber:g,animationTime:o})})},touchMove:function(u){var p=u.translate,m=r.allDistance;if(a.current.end&&(clearTimeout(a.current.end),F.instance().update("")),!(p>0||Math.abs(p)>m)){var g=r.frames;g=Math.abs(Math.ceil(p/m*n)),w(function(e){return b()(b()({},e),{},{touchMoveOutStatus:!1,frames:Math.abs(g)})})}},slideChangeTransitionStart:function(u){var p=u.activeIndex,m=ct(r,p,n);L(m,p)}}}),(0,X.useEffect)(function(){F.instance().append()},[]);var E=r.touchMoveOutStatus,M=r.frames;return(0,D.jsxs)("div",{className:N.animationContainer,children:[(0,D.jsx)("div",{className:N.holder}),(0,D.jsx)("div",{className:et()(N.animate,E?"animate_gamelist_icon":""),style:{backgroundPosition:"".concat(0,"% ",Math.abs(M/n)*100,"%"),backgroundImage:"url(".concat(l,")")}})]})}),ut=dt}}]);
